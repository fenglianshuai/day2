"use strict";define(["jquery","zepto","text!template/index.html","handlebars","swiper","text!template/Bestseller.html","text!template/list.html","text!template/love.html","text!template/handpick.html","text!template/recommend.html","lazyload","text!template/bookrack.html"],function(s,a,l,i,c,r,d,f,m,h,t,u){function p(t,e,a,o){var n=i.compile(t)(e);0==o?a.append(n):a.html(n)}function g(t,e){var a=5*t,o=5*t+5,n=e.slice(a,o);return n.map(function(t,e){t.count=e+1}),n}s("h1 span").on("click",function(){var t=s(this).index();s(".left").css("transform","translateX(-"+100*t+"%)").siblings().css("transform","translateX(-"+100*t+"%)"),s(this).addClass("active").siblings().removeClass("active")}),a("#section").on("touchstart",function(t){var e=t.touches[0].pageX;a(this).on("touchmove",function(t){e>t.touches[0].pageX?a(this).on("touchend",function(){s(this).off("touchmove touchstatrt"),s(this).find(".left").css("transform","translateX(-100%)").siblings().css("transform","translateX(-100%)"),s("h1 span").eq(1).addClass("active").siblings().removeClass("active")}):a(this).on("touchend",function(){a(this).off("touchmove touchstatrt"),s(this).find(".left").css("transform","translateX(0)").siblings().css("transform","translateX(0)"),s("h1 span").eq(0).addClass("active").siblings().removeClass("active")})})}),s.ajax({url:"/api/home",dataType:"json",success:function(t){p(l,t.items[0].data.data,s(".bander"));new c(".swiper-container",{loop:!0,autoplay:!0});p(r,t.items[1],s(".bestseller")),t.items[5].data.data.map(function(t,e){t.title=t.data.title,t.cover=t.data.cover,t.fiction=t.data.fiction}),p(r,t.items[5],s(".time"));p(d,g(0,t.items[2].data.data),s(".recommended-box"));var e=s(".recommended-box").find("dl").data("ind");s(".btn").on("click",function(){p(d,g(5===++e?e=0:e,t.items[2].data.data),s(".recommended-box")),s("img.img").lazyload({effect:"fadeIn",container:s(".left")})}),p(f,g(0,t.items[3].data.data),s(".schoolgirl-box"));var a=s(".schoolgirl-btn").parents(".schoolgirl-love").data("ind");s(".schoolgirl-btn").on("click",function(){p(f,g(3===++a?a=0:a,t.items[3].data.data),s(".schoolgirl-box")),s("img.img").lazyload({effect:"fadeIn",container:s(".left")})}),p(f,g(0,t.items[4].data.data),s(".boy-box"));var o=s(".boy-btn").parents(".boy-love").data("ind");s(".boy-btn").on("click",function(){p(f,g(3===++o?o=0:o,t.items[4].data.data),s(".boy-box")),s("img.img").lazyload({effect:"fadeIn",container:s(".left")})}),p(m,t.items[6].data.data,s(".handpick-box")),function a(){s(".left").on("scroll",function(){s(".left-box").offset().top;var t=s(".loadMore").offset().top,e=s("section").height();t-40<e&&(console.log("ok"),s(".left").off("scroll"),s.ajax({url:"/api/scroll"+n,dataType:"json",success:function(t){0===t.code?(s(".loadMore").html("加载完成"),s(".left").off("scroll")):(p(h,t.items,s(".recommend-box"),0),a(),++n),s("img.img").lazyload({effect:"fadeIn",container:s(".left")})}}))})}();var n=1;p(u,t.items[1].data.data,s(".right-box"));var i=!0;s(".list").on("click",function(){i?(i=!1,p(u,t.items[1].data,s(".right-box")),s(this).css({background:"url(http://image.read.duokan.com/mfsv2/download/fdsc3/p014nDc0lHYW/lDeZ3lL4nmgnmf.png) no-repeat center","background-size":"8 px"})):(i=!0,p(u,t.items[1].data.data,s(".right-box")),s(this).css({" background":"url(http://image.read.duokan.com/mfsv2/download/fdsc3/p01yLF3fEj8l/b7UfAdlfufQKML.png) no-repeat center"," background - size":"pxrem(15 px)"}))}),s("img.img").lazyload({effect:"fadeIn",container:s(".left")}),s(".txt").on("click",function(){window.location.href="page/seek.html"}),s(".login").on("click",function(){window.location.href="page/login.html"})}}),i.registerHelper("ind",function(t){return"0"+(t+1)})});